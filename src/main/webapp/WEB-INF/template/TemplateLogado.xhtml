<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <meta charset="UTF-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <h:outputStylesheet library="css" name="file.css"/>
    <title>Sistema de Vendas</title>
</h:head>

<h:body style="min-height: 100vh; display: flex; flex-direction: column">

    <header class="page-header">

        <button class="menu-toggle" onclick="toggleMenu()">
            <i class="pi pi-bars"></i>
        </button>

        <div class="header-left">
            <h:outputLink value="#{request.contextPath}/venda/pages/DashboardVendas.xhtml">

                <h:graphicImage library="imagens"
                                name="CapsuleCorp.png"
                                styleClass="banner-left"/>
            </h:outputLink>
        </div>

        <div class="header-center">

            <h:graphicImage library="imagens"
                            name="Capsule1.png"
                            styleClass="banner-center"/>

            <h:graphicImage library="imagens"
                            name="Capsule2.png"
                            styleClass="banner-center"/>

            <h:graphicImage library="imagens"
                            name="Capsule3.png"
                            styleClass="banner-center"/>

            <h:graphicImage library="imagens"
                            name="DragonRadar.jfif"
                            styleClass="banner-center"/>
        </div>

        <div class="header-user">
            <span class="welcome-text">Olá, tudo bem?</span>

            <h:form>
                <p:menuButton value="#{sessaoUsuario.usuarioLogado.nome}"
                              icon="pi pi-user"
                              styleClass="user-menu-btn">

                    <p:menuitem value="Alterar Usuario"
                                icon="pi pi-user-edit"
                                outcome="/venda/pages/usuario/EditarUsuario.xhtml"/>

                    <p:menuitem value="Alterar Senha"
                                icon="pi pi-lock"
                                outcome="/venda/pages/usuario/EditarSenha.xhtml"/>

                    <p:divider/>

                    <p:menuitem value="Sair"
                                icon="pi pi-sign-out"
                                action="#{loginMB.deslogar()}"
                                styleClass="ui-menuitem-danger"/>
                </p:menuButton>
            </h:form>

        </div>
    </header>

    <div class="layout">
        <aside class="menu">
            <div class="menu-header">
                <h2>Menu principal</h2>

                <button class="menu-toggle" onclick="toggleMenu()">
                    <i class="pi pi-bars"></i>
                </button>
            </div>
            <nav class="menu-nav">

                <h:link id="home"
                        outcome="/venda/pages/DashboardVendas.xhtml">
                    <i class="pi pi-home"></i>
                    <span>Home - Capsule Corp</span>
                </h:link>
                <p:tooltip for="home"
                           value="Home - Capsule Corp"
                           position="right"/>

                <h:link id="cadastroCliente"
                        outcome="/venda/pages/cliente/GerenciarClientes.xhtml">
                    <i class="pi pi-user-plus"></i>
                    <span>Cadastrar Clientes</span>
                </h:link>
                <p:tooltip for="cadastroCliente"
                           value="Cadastrar Clientes"
                           position="right"/>

                <h:link id="cadastroProduto"
                        outcome="/venda/pages/produto/GerenciarProdutos.xhtml">
                    <i class="pi pi-box"></i>
                    <span>Cadastrar Produtos</span>
                </h:link>
                <p:tooltip for="cadastroProduto"
                           value="Cadastrar Produtos"
                           position="right"/>

                <h:link id="emitirPedido"
                        outcome="/venda/pages/pedido/GerenciarPedidos.xhtml">
                    <i class="pi pi-shopping-cart"></i>
                    <span>Emitir Pedidos</span>
                </h:link>
                <p:tooltip for="emitirPedido"
                           value="Emitir Pedidos"
                           position="right"/>

                <h:link id="gerenciarUsuarios"
                        outcome="/venda/pages/usuario/GerenciarUsuarios.xhtml"
                        rendered="#{sessaoUsuario.usuarioLogado.admin}"
                        styleClass="menu-item">
                    <i class="pi pi-users"></i>
                    <span>Gerenciar Usuários</span>
                </h:link>
                <p:tooltip for="gerenciarUsuarios"
                           value="Gerenciar Usuários"
                           position="right"/>
            </nav>
        </aside>

        <main class="conteudo" style="flex: 1">
            <ui:insert name="corpo"/>
        </main>

    </div>

    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
        <p:commandButton value="Não" type="button"
                         styleClass="ui-confirmdialog-no ui-button-secondary"
                         icon="pi pi-times"/>
        <p:commandButton value="Sim" type="button"
                         styleClass="ui-confirmdialog-yes ui-button-danger"
                         icon="pi pi-check"/>
    </p:confirmDialog>

    <footer style="margin-top: 0;">
        <h2>© 2025 • Desenvolvido por Gustavo Fernandes</h2>
    </footer>

    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function () {

            const menu = document.querySelector(".menu");

            // 1️⃣ Restaura estado salvo
            const menuState = localStorage.getItem("menuState");
            if (menuState === "collapsed") {
                menu.classList.add("collapsed");
            }

            // 2️⃣ Função global do botão ☰
            window.toggleMenu = function () {

                if (window.innerWidth &lt;= 768) {
                    // MOBILE → abre/fecha
                    menu.classList.toggle("open");
                    return;
                }

                // DESKTOP → colapsa/expande
                menu.classList.toggle("collapsed");

                // salva estado
                if (menu.classList.contains("collapsed")) {
                    localStorage.setItem("menuState", "collapsed");
                } else {
                    localStorage.setItem("menuState", "expanded");
                }
            };

        });
    </script>
</h:body>
</html>


