<ui:composition template="/WEB-INF/template/TemplateLogado.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="corpo">
        <h:form>
            <p:growl id="aviso" autoUpdate="true" showDetail="true" life="3000"/>
            <div class="card">
                <h1 style="text-align: center; margin-top: 2rem; font-size: 3rem;">Cadastro de cliente</h1>

                <div class="grid ui-fluid" style="display: flex; justify-content: center; margin-top: 3rem">
                    <div class="col-12 md:col-4"
                         style="display: flex; flex-direction: column; gap: 0.5rem; width: 100%;">
                        <p:accordionPanel multiple="true" scrollIntoView="center" activeIndex="0,1">
                            <p:tab title="Dados do cliente">
                                <div style="display: flex; flex-direction: column; gap: 1rem;">
                                    <div style="display: flex; gap: 1.5rem;">
                                        <div style="flex: 3; display: flex; flex-direction: column;">
                                            <p:outputLabel value="Nome Completo/Razão Social" styleClass="soft-label"/>
                                            <p:inputText value="#{cadastroClienteMB.cliente.nome}" id="nome"
                                                         maxlength="60"
                                                         placeholder="Informe o nome/razão social" required="true"
                                                         requiredMessage="Nome/Razão social é obrigatório"/>
                                        </div>
                                        <div style="flex: 2; display: flex; flex-direction: column;">
                                            <p:outputLabel value="CPF/CNPJ" styleClass="soft-label"/>
                                            <p:inputText value="#{cadastroClienteMB.cliente.documento}"
                                                         id="documento"
                                                         placeholder="Informe o CPF/CNPJ"
                                                         required="true"
                                                         requiredMessage="CPF/CNPJ é obrigatório"
                                                         maxlength="18"
                                                         oninput="aplicarMascaraCpfCnpj(this)"/>
                                        </div>
                                        <div style="flex: 1.5; display: flex; flex-direction: column;">
                                            <p:outputLabel value="Inscrição Estadual/RG" styleClass="soft-label"/>
                                            <p:inputText value="#{cadastroClienteMB.cliente.inscricaoEstadual}"
                                                         id="inscricaoEstadual"
                                                         maxlength="14"
                                                         placeholder="Informe o IE/RG" required="true"
                                                         requiredMessage="IE/RG é obrigatório"/>
                                        </div>
                                    </div>
                                </div>
                            </p:tab>
                            <p:tab title="Dados de endereço">
                                <div style="display: flex; flex-direction: column; gap: 1rem;">
                                    <div style="display: flex; gap: 1.5rem;">
                                        <div style="flex: 4; display: flex; flex-direction: column;">
                                            <p:outputLabel value="Endereço" styleClass="soft-label"/>
                                            <p:inputText value="#{cadastroClienteMB.cliente.logradouro}"
                                                         id="logradouro"
                                                         maxlength="60"
                                                         placeholder="Informe o endereço" required="true"
                                                         requiredMessage="Endereço é obrigatório"/>
                                        </div>
                                        <div style="flex: 1; display: flex; flex-direction: column; max-width: 120px">
                                            <p:outputLabel value="Número" styleClass="soft-label"/>
                                            <p:inputText value="#{cadastroClienteMB.cliente.numero}" id="numero"
                                                         maxlength="6"
                                                         placeholder="N°" required="true"
                                                         requiredMessage="Numero é obrigatório"/>
                                        </div>
                                        <div style="flex: 2; display: flex; flex-direction: column;">
                                            <p:outputLabel value="Bairro" styleClass="soft-label"/>
                                            <p:inputText value="#{cadastroClienteMB.cliente.bairro}" id="bairro"
                                                         maxlength="60"
                                                         placeholder="Informe o bairro" required="true"
                                                         requiredMessage="Bairro é obrigatório"/>
                                        </div>
                                    </div>
                                    <div style="display: flex; gap: 1rem;">
                                        <div style="flex: 0 0 130px; display: flex; flex-direction: column;">
                                            <p:outputLabel value="CEP" styleClass="soft-label"/>
                                            <p:inputMask value="#{cadastroClienteMB.cliente.cep}" id="CEP"
                                                         maxlength="9"
                                                         placeholder="Informe o CEP" mask="99999-999"
                                                         required="true"
                                                         requiredMessage="CEP é obrigatório"/>
                                        </div>
                                        <div style="flex: 2; display: flex; flex-direction: column;">
                                            <p:outputLabel value="Cidade" styleClass="soft-label"/>
                                            <p:inputText value="#{cadastroClienteMB.cliente.cidade}" id="cidade"
                                                         maxlength="60"
                                                         placeholder="Informe a cidade" required="true"
                                                         requiredMessage="Cidade é obrigatório"/>
                                        </div>
                                        <div style="flex: 0 0 80px; display: flex; flex-direction: column;">
                                            <p:outputLabel value="Estado" styleClass="soft-label"/>
                                            <p:inputText value="#{cadastroClienteMB.cliente.estado}" id="estado"
                                                         maxlength="20"
                                                         placeholder="UF" required="true"
                                                         requiredMessage="Estado é obrigatório"/>
                                        </div>
                                        <div style="flex: 2; display: flex; flex-direction: column;">
                                            <p:outputLabel value="Complemento" styleClass="soft-label"/>
                                            <p:inputText value="#{cadastroClienteMB.cliente.complemento}"
                                                         id="complemento"
                                                         maxlength="60"
                                                         placeholder="Informe o complemento (ex: apto 123)"/>
                                        </div>
                                    </div>
                                </div>
                            </p:tab>
                        </p:accordionPanel>
                    </div>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 1rem">
                    <p:button value="Voltar"
                              outcome="/venda/pages/cliente/GerenciarClientes.xhtml"
                              styleClass="ui-button-secondary"
                              style="min-width: 180px"
                    />
                    <p:commandButton action="#{cadastroClienteMB.cadastrarCliente()}"
                                     value="Cadastrar"
                                     icon="pi pi-user-plus"
                                     ajax="false"
                                     styleClass="ui-button-primary"
                                     update="aviso"
                                     style="min-width: 180px"/>
                </div>
            </div>
            <script type="text/javascript">
                //<![CDATA[
                function aplicarMascaraCpfCnpj(input) {
                    let valor = input.value.replace(/\D/g, '');

                    if (valor.length <= 11) {
                        // CPF
                        valor = valor.replace(/(\d{3})(\d)/, '$1.$2');
                        valor = valor.replace(/(\d{3})(\d)/, '$1.$2');
                        valor = valor.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                    } else {
                        // CNPJ
                        valor = valor.replace(/^(\d{2})(\d)/, '$1.$2');
                        valor = valor.replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3');
                        valor = valor.replace(/\.(\d{3})(\d)/, '.$1/$2');
                        valor = valor.replace(/(\d{4})(\d{1,2})$/, '$1-$2');
                    }

                    input.value = valor;
                }

                //]]>
            </script>
        </h:form>
    </ui:define>
</ui:composition>